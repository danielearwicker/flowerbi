# FlowerBI Tools

Command-line tools for generating TypeScript and C# code from FlowerBI YAML schema definitions.

## Installation

```bash
npm install -g @flowerbi/tools
```

## Usage

### Generate TypeScript

```bash
flowerbi-tools ts schema.yaml output.ts
```

This generates TypeScript column definitions that can be used with the FlowerBI client library.

**Example output:**
```typescript
import { StringQueryColumn, IntegerQueryColumn, QueryColumnRuntimeType, QueryColumnDataType } from "@flowerbi/client";

export const User = {
    Id: new IntegerQueryColumn<number>("User.Id",
        new QueryColumnRuntimeType(QueryColumnDataType.int, "")
    ),
    Name: new StringQueryColumn<string>("User.Name",
        new QueryColumnRuntimeType(QueryColumnDataType.string, "")
    ),
};

export const MySchema = {
    User,
};

export const yaml = `
schema: MySchema
tables:
  User:
    id:
      Id: [int]
    columns:
      Name: [string]
`;
```

### Generate C#

```bash
flowerbi-tools cs schema.yaml output.cs MyNamespace
```

This generates C# constant definitions for use in .NET applications.

**Example output:**
```csharp
#nullable enable
namespace MyNamespace;

// Important: this file is auto-generated by flowerbi.

public static class MySchema
{
    public const string Name = "MySchema";
    
    public static class User
    {
        public const string Name = "User";
        public const string Id = "User.Id";
        public const string Name = "User.Name";
    }
    
    public const string Yaml = """
        schema: MySchema
        tables:
          User:
            id:
              Id: [int]
            columns:
              Name: [string]
        """;
}
```

## Programmatic Usage

You can also use the generators programmatically:

```typescript
import { TypeScriptGenerator, CSharpGenerator } from '@flowerbi/tools';

// Generate TypeScript
const tsResult = TypeScriptGenerator.fromYaml(yamlText);
console.log(tsResult.code);

// Generate C#
const csResult = CSharpGenerator.fromYaml(yamlText, 'MyNamespace');
console.log(csResult.code);
```

## Schema Format

The tools work with FlowerBI YAML schema definitions. See the main FlowerBI documentation for schema format details.

## Integration with Build Systems

### TypeScript Projects

Add to your `package.json`:

```json
{
  "scripts": {
    "generate-schema": "flowerbi-tools ts schema.yaml src/generated/schema.ts"
  }
}
```

### .NET Projects

Add to your `.csproj`:

```xml
<Target Name="GenerateSchema" BeforeTargets="BeforeBuild">
  <Exec Command="flowerbi-tools cs schema.yaml Generated/Schema.cs MyProject.Generated" />
</Target>
```

## Comparison with C# Version

This TypeScript implementation produces identical output to the C# `FlowerBI.Tools` package, ensuring consistency across language ecosystems. The core generation logic has been ported to enable future integration where C# calls into the JavaScript bundle for code generation.